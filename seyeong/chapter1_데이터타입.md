# JavaScript 데이터 타입과 메모리 관리

## 1. 데이터 타입의 종류

JavaScript의 데이터 타입은 크게 기본형(Primitive Type)과 참조형(Reference Type)으로 나뉨

### 기본형 데이터

- number
- string
- boolean
- null
- undefined
- symbol

기본형의 특징은 할당이나 연산 시 값이 복제되며, 값이 담긴 주솟값을 바로 복제하고 `불변성(immutability)`을 띔

### 참조형 데이터

- object (Map, WeakMap, Set, WeakSet)
- array
- function
- date
- regexp

참조형의 특징은 할당이나 연산 시 참조되며, 값이 담긴 주솟값들로 이루어진 묶음을 가리키는 주솟값을 복제

## 2. 데이터 타입에 관한 배경지식

모든 데이터는 바이트 단위의 식별자, 즉 '메모리 주솟값'을 통해 서로 구분하고 연결할 수 있다.

- 변수(variable): 변할 수 있는 데이터 (숫자, 문자열, 객체, 배열 등)
- 식별자: 어떤 데이터를 식별하는데 사용하는 이름 (변수명)

## 3. 변수 선언과 데이터 할당

### 변수 선언

변수는 변경 가능한 데이터가 담길 수 있는 공간 또는 그릇
컴퓨터가 변수를 선언하면 메모리 영역에서 아래와 같은 작업을 수행

```javascript
var a; // 변할 수 있는 데이터를 만들고, 이 데이터의 식별자는 a로 지정
```

| 주소   | ... | 1002 | 1003          | 1004 | 1005 | ... |
| ------ | --- | ---- | ------------- | ---- | ---- | --- |
| 데이터 |     |      | 이름: a / 값: |      |      |     |

### 데이터 할당

```javascript
var a; // 변수 a 선언
a = "abc"; // 변수에 데이터 할당

// 또는
var a = "abc"; // 변수 선언과 할당을 한 문장으로 표현
```

**실제로 변수에 문자열을 직접 저장하지 않고**, 데이터를 저장하기 위한 별도의 메모리 공간을 확보해서 문자열을 저장한 후, 그 주소를 변수 영역에 저장

변수 영역:
| 주소 | ... | 1002 | 1003 | 1004 | 1005 | ... |
|------|-----|------|------|------|------|-----|
| 데이터 | | | 이름: a / 값: @5004 | | | |

데이터 영역:
| 주소 | ... | 5002 | 5003 | 5004 | 5005 | ... |
|------|-----|------|------|------|------|-----|
| 데이터 | | | | 'abc' | | |

> **할당 과정 순서**
>
> 1. 변수 영역에서 빈 공간(@1003)을 확보
> 2. 확보한 공간의 식별자를 a로 지정
> 3. 데이터 영역의 빈 공간(@5004)에 문자열 'abc' 저장
> 4. 변수 영역에서 a라는 식별자를 검색(@1003)
> 5. 앞서 저장한 문자열의 주소(@5004)를 @1003의 공간에 대입

## 4. 기본형 데이터와 참조형 데이터

### 불변값

변수(variable)와 상수(constant)를 구분하는 성질은 `변경 가능성`

그러나 불변값은 상수와는 다른 개념이다.

- 변수 vs 상수: 변수 영역 메모리의 변경 가능성으로 구분
- 불변성: 데이터 영역 메모리의 변경 가능성으로 구분

기본형 데이터(숫자, 문자열, boolean, null, undefined, Symbol)는 모두 불변값

불변성 예시:

```javascript
var a = "abc"; // 변수 a에 'abc' 데이터 주소 할당
a = a + "def"; // 새로운 문자열 'abcdef'를 만들어 a에 주소 저장

var b = 5; // 변수 b에 숫자 5 할당
var c = 5; // b에 할당한 숫자 5의 주솟값 재활용
b = 7; // 새로운 숫자 7을 데이터 영역에서 찾거나 생성해서 주솟값 변경
```

### 가변값

참조형 데이터의 기본적인 성질은 가변값인 경우가 많음. 다만 설정에 따라 변경 불가하게 활용할 수도 있다.

참조형 데이터 할당 예시:

```javascript
var obj1 = {
  a: 1,
  b: "bbb",
};
```

변수 영역:
| 주소 | ... | 1002 | 1003 | 1004 | 1005 | ... |
|------|-----|------|------|------|------|-----|
| 데이터 | | 이름: obj1, 값: @5001 | | | | |

데이터 영역:
| 주소 | ... | 5001 | 5002 | 5003 | 5004 | ... |
|------|-----|------|------|------|------|-----|
| 데이터 | | @7103 ~ ? | | 1 | 'bbb' | |

객체 @5001의 변수 영역:
| 주소 | ... | 7103 | 7104 | 7105 | 7106 | ... |
|------|-----|------|------|------|------|-----|
| 데이터 | | 이름: a, 값: @5003 | 이름: b, 값: @5004 | | | |

## 5. 불변 객체

불변 객체(immutable object)는 최근 React, Vue.js, Angular 등의 라이브러리나 프레임워크뿐만 아니라, 함수형 프로그래밍, 디자인 패턴 등에서도 매우 중요한 개념

### 얕은 복사와 깊은 복사

얕은 복사(shallow copy)는 `바로 아래 단계의 값만 복사`

```javascript
// 얕은 복사
var copyObject = function (target) {
  var result = {};
  for (var prop in target) {
    result[prop] = target[prop];
  }
  return result;
};
```

깊은 복사(deep copy)는 내부의 모든 값들을 하나하나 찾아서 `전부 복사`

```javascript
// 깊은 복사
var copyObjectDeep = function (target) {
  var result = {};
  if (typeof target === "object" && target !== null) {
    for (var prop in target) {
      result[prop] = copyObjectDeep(target[prop]);
    }
  } else {
    result = target;
  }
  return result;
};
```

## 6. undefined와 null

`undefined`와 `null`은 자바스크립트에서 모두 '없음'을 나타내지만, 미세한 차이가 있다.

### undefined

자바스크립트 엔진은 다음과 같은 경우에 `undefined`를 반환

1. 값을 대입하지 않은 변수 접근 시
2. 객체 내부의 존재하지 않는 프로퍼티 접근 시
3. return 문이 없거나 호출되지 않는 함수의 실행 결과

### null

`null`은 '비어있음'을 명시적으로 나타내고 싶을 때 사용.

typeof null은 object를 반환하는데, 이는 자바스크립트의 버그다.

따라서 변수의 값이 null인지 확인하려면 일치 연산자로 확인 필요

(undefined와 null을 구분하기 위해서는 동등 연산자 대신, 일치 연산자(===)를 사용)

```javascript
var n = null;
console.log(typeof n); // object

console.log(n == undefined); // true
console.log(n == null); // true

console.log(n === undefined); // false
console.log(n === null); // true
```
